
---
title: "Análisis Comparativo de SNVs en miRNAs: ALS vs Control"
subtitle: "Análisis Completo con Visualizaciones"
author: "Análisis de Datos Ómicos"
date: "`r Sys.Date()`"
output: 
  ioslides_presentation:
    widescreen: true
    smaller: true
    transition: "default"
    theme: "flatly"
    css: "custom.css"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.width = 12, fig.height = 8)
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)
library(gridExtra)
library(viridis)
library(RColorBrewer)
library(ComplexHeatmap)
library(circlize)
```

# Análisis Comparativo de SNVs en miRNAs: ALS vs Control

## Análisis Completo con Visualizaciones

**Dataset**: Magen ALS Blood Plasma Study  
**Muestras**: 415 (313 ALS + 102 Control)  
**SNVs**: 4,472 después de preprocesamiento  
**miRNAs**: 1,247 únicos  

---

## Objetivos del Estudio

- **Analizar diferencias** en patrones de oxidación entre grupos ALS y Control
- **Identificar SNVs discriminativos** por posición en miRNAs
- **Evaluar validez estadística** de los hallazgos
- **Desarrollar métricas** de carga oxidativa diferencial
- **Validar artefactos técnicos** y realizar análisis robustos

---

## Metodología y Proceso

### Pipeline de Análisis
1. **Preprocesamiento robusto** con filtros de calidad
2. **Análisis por posición** con normalización RPM
3. **Clustering jerárquico** y análisis PCA
4. **Validación técnica** de artefactos
5. **Análisis de pathways** y redes de miRNAs

### Filtros Aplicados
- **G>T**: Solo mutaciones oxidativas
- **Split/Collapse**: Manejo de múltiples mutaciones
- **VAF > 0.5 → NaN**: Conversión de VAFs altos
- **RPM > 1**: Filtro de abundancia mínima
- **Calidad**: Al menos 2 muestras por grupo

---

## Análisis por Posición

### Distribución de SNVs por Posición

![Distribución por Posición](distribucion_por_posicion_filtrado.pdf)

### Hallazgos Clave
- **Posición 6**: Punto caliente de mutaciones G>T
- **Región Seed (posiciones 2-6)**: Mayor diferenciación
- **Significancia estadística**: Posiciones 1-5 significativas

### Análisis Detallado de Posición 6

![Análisis Posición 6](boxplot_vafs_posicion_6.pdf)

**Características de la posición 6:**
- Mayor abundancia de SNVs G>T
- Diferencias significativas entre grupos
- Potencial rol funcional en patogénesis

---

## Carga Oxidativa Diferencial

### Comparación de Scores de Carga Oxidativa

![Carga Oxidativa](figures_oxidative_load/01_boxplot_oxidative_score.png)

### Resultados Principales
- **Control**: Mayor carga oxidativa que ALS
- **Diferencia estadísticamente significativa** (p < 0.001)
- **Implicaciones**: Mecanismos de respuesta al estrés oxidativo

### Correlación SNVs vs VAF Total

![Correlación SNVs](figures_oxidative_load/02_scatter_snvs_vs_total_vaf.png)

### Distribución de Scores

![Distribución Scores](figures_oxidative_load/03_histogram_oxidative_score.png)

---

## Análisis PCA Robusto

### Separación en Componentes Principales

![PCA PC1 vs PC2](figures_robust_pca/01_pca_scatter_pc1_pc2.png)

### Varianza Explicada

![Varianza Explicada](figures_robust_pca/03_variance_explained.png)

### Contribuciones por Posición

![Contribuciones Posición](figures_robust_pca/04_position_contributions_heatmap.png)

### Hallazgos PCA
- **Separación parcial** entre grupos ALS y Control
- **PC1**: Explica 35.2% de la varianza
- **PC2**: Explica 23.1% de la varianza
- **Posiciones clave**: Contribuyen diferencialmente

---

## Validación Técnica: hsa-miR-6133

### Distribución de VAFs

![Distribución miR-6133](figures_mir6133_validation/01_vaf_distribution_mir6133_6gt.png)

### Comparación con Otros miRNAs

![Comparación miRNAs](figures_mir6133_validation/02_comparison_other_mirnas.png)

### Correlación con Carga Oxidativa

![Correlación Carga](figures_mir6133_validation/03_correlation_oxidative_load.png)

### Conclusiones de Validación
- **hsa-miR-6133_6:GT** identificado como artefacto técnico
- **VAFs anómalamente altos** (0.7-0.9 vs 0.01-0.1)
- **Excluido** de análisis robustos para evitar sesgos

---

## Análisis de Pathways y Redes

### Contribuciones de Familias de miRNAs

![Familias miRNAs](figures_pathways/01_family_contributions_heatmap.png)

### Contribuciones por Posición

![Contribuciones Posición](figures_pathways/02_position_contributions.png)

### Red de Correlaciones

![Red Correlaciones](figures_pathways/03_miRNA_correlations_heatmap.png)

### Red de miRNAs

![Red miRNAs](figures_pathways/04_miRNA_network.png)

### Hallazgos de Pathways
- **Identificación** de miRNAs clave en patogénesis
- **Patrones de red** que sugieren mecanismos funcionales
- **Familias específicas** con mayor contribución

---

## Análisis Clínico y Correlaciones

### Correlación con Edad

![Correlación Edad](figures_clinical_correlation/01_boxplot_edad_grupo.png)

### Correlación con Sexo

![Correlación Sexo](figures_clinical_correlation/02_boxplot_sexo_grupo.png)

### Curva ROC

![Curva ROC](figures_clinical_correlation/03_curva_roc.png)

### Matriz de Correlaciones Clínicas

![Matriz Correlaciones](figures_clinical_correlation/04_correlation_matrix_clinical.png)

### Hallazgos Clínicos
- **Correlaciones significativas** con variables clínicas
- **Potencial diagnóstico** con AUC > 0.7
- **Factores de confusión** identificados y controlados

---

## Heatmaps y Clustering

### Heatmap de VAFs

![Heatmap VAFs](heatmap_vafs_posiciones_significativas.pdf)

### Heatmap de Z-scores

![Heatmap Z-scores](heatmap_zscores_posiciones_significativas.pdf)

### Clusters Verificados

![Clusters Verificados](heatmap_clusters_verificado.pdf)

### Interpretación de Heatmaps
- **VAFs**: Valores absolutos, matriz dispersa
- **Z-scores**: Valores relativos, patrones más definidos
- **Clustering**: Agrupación por perfiles de expresión

---

## Discusión: Validez de VAFs y Z-scores

### Comparación de Distribuciones

![Comparación Distribuciones](comparacion_distribuciones_vaf_zscore.pdf)

### Justificación Metodológica

**Heatmap de VAFs:**
- Valores absolutos de frecuencia alélica
- Útil para identificar presencia y magnitud
- Matriz dispersa debido a rareza de mutaciones

**Heatmap de Z-scores:**
- Valores estandarizados (desviación del promedio)
- Resalta diferencias relativas entre grupos
- Más efectivo para identificar patrones diferenciales

### Conclusión sobre Validez
- **Ambos enfoques** son válidos y complementarios
- **VAFs**: Magnitud absoluta de mutaciones
- **Z-scores**: Patrones de variación diferencial
- **Combinación**: Interpretación más robusta

---

## Hallazgos Principales

### 1. Carga Oxidativa Diferencial
- **Control > ALS** en carga oxidativa (p < 0.001)
- **Implicaciones**: Mecanismos de respuesta al estrés oxidativo
- **Potencial**: Biomarcador de estado oxidativo

### 2. Patrones por Posición
- **Posición 6**: Punto caliente de mutaciones G>T
- **Región Seed**: Mayor diferenciación entre grupos
- **Funcionalidad**: Rol en patogénesis de ALS

### 3. Identificación de Artefactos
- **hsa-miR-6133**: Artefacto técnico dominante
- **Validación**: Crucial para robustez de resultados
- **Metodología**: Aplicable a otros estudios ómicos

### 4. Análisis Robusto
- **PCA**: Separación parcial entre grupos
- **Redes**: miRNAs clave identificados
- **Clínico**: Correlaciones significativas

---

## Conclusiones y Perspectivas

### Conclusiones Clave
- **Diferencias significativas** en patrones de oxidación
- **Validación técnica** esencial para robustez
- **Z-scores** herramienta poderosa para datos esparsos
- **Metodología robusta** aplicable a otros estudios

### Implicaciones Clínicas
- **Biomarcadores potenciales** de oxidación para ALS
- **Nuevos insights** sobre patogénesis
- **Aplicación clínica** en diagnóstico y pronóstico

### Perspectivas Futuras
- **Replicación** en cohortes independientes
- **Validación experimental** de miRNAs clave
- **Integración** con otros datos ómicos
- **Modelos predictivos** avanzados

---

## Agradecimientos

**Dataset**: Magen ALS Blood Plasma Study  
**Metodología**: Análisis robusto de SNVs en miRNAs  
**Validación**: Identificación y exclusión de artefactos técnicos  
**Visualización**: Análisis completo con múltiples enfoques  

---

## Preguntas y Discusión

**¿Preguntas sobre la metodología, resultados o implicaciones?**

---

## Referencias y Metodología Detallada

### Pipeline Completo
1. **Preprocesamiento**: Filtros G>T, split/collapse, VAFs
2. **Análisis posicional**: RPM, Fisher exact test
3. **Carga oxidativa**: Métricas personalizadas
4. **PCA robusto**: Sin artefactos técnicos
5. **Pathways**: Redes y correlaciones
6. **Validación**: Identificación de artefactos

### Software y Paquetes
- **R**: Análisis estadístico y visualización
- **ggplot2**: Gráficos de alta calidad
- **ComplexHeatmap**: Heatmaps avanzados
- **igraph**: Análisis de redes
- **rmarkdown**: Presentaciones interactivas

---

## Fin de la Presentación

**Gracias por su atención**

*Análisis realizado con R y paquetes especializados en bioinformática*

**Contacto**: Para más detalles sobre metodología o resultados

